\newcommand{\fun}[1]{
  \text{#1}
}

\begin{figure}[t]
  %\judgement{Specification Typing}{$\Gamma \vdash \sigma: d_f$, $\Gamma \vdash e: t$}
  \judgement{Specification Typing}{}
  %\begin{alignat*}{2}
    %\fun{param}(\SpecCall{f}{(x : y)^*}{x^*}{y^*} ...) & = 1
  %\end{alignat*}
  \small
  \infrule[a-spec]{
    \Gamma(x_\text{addr}) = \Keywd{address} \qquad
    \Gamma' = \Gamma,~
              \boldsymbol{x}_i : \boldsymbol{t}_i \qquad
    \Gamma'' = \Gamma',~
              \boldsymbol{y}_j : \boldsymbol{r}_j \\
    \Gamma' \vdash e_1 : \Keywd{bool} \qquad
    \Gamma'' \vdash e_2 : \Keywd{bool}
  }{
    \Gamma \vdash 
    \SpecCall{\K(x_\text{addr}).f}{\boldsymbol{x}_i}{\boldsymbol{y}_j}~
    \Keywd{requires}~ e_1 ~\Keywd{ensures}~ e_2 \; : \\
    \FunType{f}{\boldsymbol{t}_i ~ \boldsymbol{x}'_i}{m}{\boldsymbol{r}_j}
  }

  \infrule[f-spec]{
    \Gamma' = \Gamma,~
              \boldsymbol{x}_i : \boldsymbol{t}_i \qquad
    \Gamma'' = \Gamma',~
              \boldsymbol{y}_j : \boldsymbol{r}_j \\
    \Gamma' \vdash e_1 : \Keywd{bool} \qquad
    \Gamma'' \vdash e_2 : \Keywd{bool} \\
    \forall k,\; \Gamma'' \vdash \sigma_k : d_{f_\text{exn}} \;\textit{s.t.}~
    \fun{target}(\sigma_k) = \K(x_\text{addr}).f_\text{exn} ~\wedge~
    d_{f_\text{exn}} \in \K
     % \fun{decl}(\fun{target}(\sigma_q^\text{\tiny addr}))
    % \Gamma \vdash \fun{addr}(\sigma) : \note{type-of-call}
  }{
    \Gamma \vdash
    \SpecCall{f}{\boldsymbol{x}_i}{\boldsymbol{y}_j} ~
    \SpecCond{e_1}{e_2}{\boldsymbol{\sigma}_k} \; : \\
    \FunType{f}{\boldsymbol{t}_i ~ \boldsymbol{x}'_i}{m}{\boldsymbol{r}_j}
  }

  \infrule[c-top]{
    \Gamma' = \Gamma,~
             \fun{id}(\boldsymbol{d}_i) : \fun{type}(\boldsymbol{d}_i),~
             \fun{id}(\boldsymbol{\F}_j) : \fun{decl}(\boldsymbol{\F}_j)
             \\
    \forall j,\; \Gamma' \vdash \fun{spec}(\F_j) : \fun{decl}(\F_j)
  }{
    \Gamma \vdash \Contract{\K}{\boldsymbol{d}_i}{\boldsymbol{\F}_j}
  }
  % \vspace{-1.5em}
  \vspace{-1mm}
  \caption{Static semantics (excerpt) of \corelang specifications. Only checkings relevant to specifications are shown.}
  \label{fig:static}
\end{figure}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "paper"
%%% End:
