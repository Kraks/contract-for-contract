% ----- listings

\definecolor{light-gray}{gray}{0.85}
%\definecolor{ckeyword}{HTML}{7F0055}
\definecolor{ckeyword}{HTML}{000000}
\definecolor{ccomment}{HTML}{3F7F5F}
\definecolor{cstring}{HTML}{2A0099}

\colorlet{shadecolor}{light-gray!40}

\lstdefinelanguage{Solidity}%
{morekeywords = {
  abstract, contracts, is,
  ether, szabo, finney, wei,
  seconds, minutes, hours, days, weeks, years,
  function, constructor, memory, calldata,
  for, if, new
  mapping,
  internal, external, pure, view, payable, return, returns,
  public, private, virtual, override,
  true, false, bool,
  bytes, bytes32,
  uint, uint8, uint16, uint32, uint64, uint128, uint256,
  int, int8, int16, int32, int64, int128, int256,
  address, string,
  require, assert, revert, try, catch
  },%
  sensitive,%
  %identifierstyle = \color{blue},
  moredelim = *[l][\itshape]{\#},
  morecomment = [l]//,%
  morecomment = [s]{/*}{*/},%
  morestring = [b]",%
  %morestring=[b]',%
  showstringspaces = false%
}[keywords,comments,strings]%

\lstset{
  language=Solidity,%
  backgroundcolor=\color{shadecolor},%
  mathescape=true,%
%  columns=[c]fixed,%
  aboveskip=2pt,%\smallskipamount,
  belowskip=1pt,%\negsmallskipamount,
  lineskip=-1pt,
  basewidth={0.6em, 0.5em},%
%  backgroundcolor=\color{listingbg},
  basicstyle=\ttfamily\small,
  keywordstyle=\keywordstyle,
  commentstyle=\commentstyle,
  stringstyle=\stringstyle,
%  xleftmargin=0.5cm
  literate={-->}{{$\to$}}2
           {->}{{$\mapsto$}}3
           {<-}{{$\leftarrow$}}2
           {=>}{{$\Rightarrow ~$}}2
           {=/>}{{$\not\Rightarrow ~$}}3
           {~>}{{$\leadsto$}}2
           {~/>}{{$\not\leadsto$}}2
           {|-}{{$\ts$}}2
           {σ}{{$\sigma$}}1
           {ρ}{{$\rho$}}1
           {→}{{$\to$}}1
           {←}{{$\leftarrow$}}1
           {λ}{{$\lambda$}}1
           {α}{{$\alpha$}}1
           {⊔}{{$\sqcup$}}1
           {⊓}{{$\sqcap$}}1
           {⊑}{{$\sqsubseteq$}}1
           {⊤}{{$\top$}}1
           {⊥}{{$\bot$}}1
           {×}{{$\times$}}1
           {τ}{{$\tau$}}1
           {ψ}{{$\psi$}}1
           {Σ}{{$\Sigma$}}1
           {⟨}{{$\langle$}}1
           {⟩}{{$\rangle$}}1
           {π}{{$\pi$}}1
           {∪}{{$\cup$}}2
           {/\\}{{$\land$}}2
           %{[[}{{$[\![$}}1
           %{]]}{{$]\!]$}}1
           %{…}{{$\!...$}}1
}

\definecolor{listingbg}{RGB}{240, 240, 240}

\newcommand{\commentstyle}[1]{\color{ccomment}\itshape{#1}}
\newcommand{\keywordstyle}[1]{\color{ckeyword}\bfseries{#1}}
\newcommand{\stringstyle}[1]{\color{cstring}\text{#1}}

\lstnewenvironment{listing}{\lstset{language=Solidity}}{}
\lstnewenvironment{listingtiny}{\lstset{language=Solidity,basicstyle=\scriptsize\ttfamily}}{}

\newcommand{\code}[1]{\lstinline[language=Solidity,columns=fixed,basicstyle=\ttfamily]|#1|}

% ----- formal

\newcommand{\judgement}[2]{{\bf #1} \hfill #2}
\newcommand{\den}[1]{\llbracket~#1~\rrbracket}

% ----- comments and todo

\newcommand{\note}[1]{{\color{red}[#1]}}
\newcommand{\todo}[1]{\note{TODO: #1}}
\newcommand{\wac}[1]{{\color{orange}[WAC: #1]}} % Wuqi's comment
\newcommand{\zz}[1]{{\color{blue}[ZZ: #1]}} % ZZ's comment
\newcommand{\yy}[1]{{\color{Plum}[YY: #1]}} % YY's comment
\newcommand{\rev}[1]{\note{Revision: #1}}
\newcommand{\silent}[1]{}
\newcommand{\hl}[1]{\setlength{\fboxsep}{0pt}\colorbox{light-gray}{#1}}

\newcommand{\lang}{\textsf{ConSol}\xspace}

\newcommand{\lb}{\{~}
\newcommand{\rb}{~\}}
\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}

\newcommand{\Typ}[1]{\ensuremath{\mathsf{#1}}}
\newcommand{\Keywd}[1]{\ensuremath{\texttt{#1}}}
\newcommand{\Ast}[1]{\ensuremath{\mathsf{#1}}}
\newcommand{\Def}[1]{\ensuremath{\mathsf{#1}}}

% ----- syntax
\newcommand{\optional}[1]{{\color{gray}\left[{\color{black}#1}\right]}}
\newcommand{\state}{\sigma} % global state of all contracts
\newcommand{\store}[1]{\delta_{#1}} % state of a individual contract

\newcommand{\addr}{\mathcal{A}}
\newcommand{\bddr}{\mathcal{B}}
\newcommand{\cddr}{\mathcal{C}}
\newcommand{\dddr}{\mathcal{D}}
\newcommand{\xddr}{\mathcal{X}}
\newcommand{\yddr}{\mathcal{Y}}
\newcommand{\sender}{\mathtt{sender}}

% ------ semantics
\newcommand{\denot}[1]{\llbracket#1\rrbracke}
